\documentclass[12pt,a4paper]{article}
\usepackage{apacite}
\usepackage{graphicx}
%\usepackage[top=4cm, bottom=4cm, outer=5cm, inner=3cm, heightrounded, marginparwidth=3cm, marginparsep=1cm]{geometry} %TODO: comment out
%\usepackage[marginparwidth=2.5cm, marginparsep=2cm]{geometry}
\usepackage[toc,page]{appendix}
\usepackage{hyperref}
\usepackage{fancyref}
\usepackage[round]{natbib}
\usepackage{fancyhdr}
\usepackage{setspace}
\usepackage{pgf}
\usepackage{capt-of}
%\usepackage[justification=centering]{caption}
\pagestyle{fancy}

\newcommand{\citetwo}[4]{(\citeauthor{#1}, \citeyear{#1}, p.~#2; \citeauthor{#3}, \citeyear{#3}, p.~#4)}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}



\begin{document}

\begin{titlepage}

\begin{center}

\textsc{\LARGE University of Edinburgh}\\[1cm]

\textsc{\Large Dissertation in Language Sciences}\\[1.5cm]

\HRule \\[0.4cm]
{ \huge \bfseries Understanding Referential Coordination as a Particle Swarm Optimization Task \\[0.4cm] }

\HRule \\[1.5cm]


\noindent
\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Exam Number:}\\
---
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Supervisor:} \\
Dr.~Hannah \textsc{Rohde}
\end{flushright}
\end{minipage}

\vfill

% Bottom of the page
{\large 1st April, 2015}
%\title{Understanding Referential Coordination as a Particle Swarm Optimization Task}
%\author{s1107496}
%\date{1st April, 2015}

%\maketitle

\end{center}
\end{titlepage}

\onehalfspace
%\doublespace

\begin{abstract}
In ``Communicating with Cost-based Implicature: a Game-Theoretic Approach to Ambiguity" \citeyearpar{rohde2012}, \citeauthor{rohde2012} sought to investigate the effects of ambiguous and unambiguous form costs on referential coordination. To do so, \citeauthor{rohde2012} ran a number of experiments in which participants played an iterated referential coordination language game. This paper takes a novel approach by modeling their results using particle swarm optimization (PSO), a general-purpose optimization method for non-differentiable problems with continuous search spaces. Two PSO-based models are presented, one of which is shown to perform well against a baseline model. Predictions from the more favourable of the two models are presented for several variants of the \citeauthor{rohde2012} language games, as well as used to partially replicate findings from \cite{brennan1996}. The relation of previous work on audience design to the particle-swarm-based model, in which agents lack an embedded representation of their interlocutors, is also discussed.
\end{abstract}

\pagebreak


\tableofcontents

\pagebreak


\section{Introduction}
An open question in the field of linguistics is how participants in a conversation coordinate their use of referring expressions. When producing referring expressions, interlocutors must weigh the costs they incur when producing the expression, both in terms of construction and articulation, against the ease with which their conversational partners will be able to infer the intended referent. When speakers employ referring expressions that do not uniquely select a referent within the context of the discourse, they further risk their conversational partner failing to infer the correct referent from those possible. For example, consider a discourse context in which there are three plausible referents, a chocolate Labrador, a black Poodle, and a brown American Water Spaniel/German Longhaired Pointer mix. Given the high cost of producing an unambiguous referring expression for the latter, a speaker might attempt to refer to the American Water Spaniel/German Longhaired Pointer mix as ``that brown dog". However, this expression could also plausibly be used to indicate the chocolate Labrador, and should the speaker's communicative partner interpret the referring expression as such, rectifying this misinterpretation is likely to be very costly. While communicating, interlocutors therefore jointly seek to minimize their expended effort while not violating the constraint imposed by their partner's ability to disambiguate the referring expressions used \citep[p.~65-66]{benz2005}. Consequentially, the referential strategy a speaker opts to adopt must be sensitive to the relative costs of producing each reference as well as the evolving state of mappings between referential form and intended referent, as coordinated with their interlocutors. 

In ``Communicating with Cost-based Implicature: a Game-Theoretic Approach to Ambiguity" \citeyearpar{rohde2012}, \citeauthor{rohde2012} introduced a language game in which participant dyads were rewarded for coordinating their use of ambiguous and unambiguous referring expressions. In human studies, participants' ability to successfully coordinate on the use of less costly ambiguous forms was shown to be affected by the relative costs of the available competing unambiguous forms. This paper seeks to introduce a computational model of \citeauthor{rohde2012}'s findings, and in doing so consider how modeling may be applied to the problem of referential coordination. Such a model would allow simulation of the experimentally infeasible or impossible, as well as enabling extrapolation from the data collected in the lab, the results of which can be used to drive further studies in potentially fruitful directions. Further to this, computational models in general uniquely allow for direct inspection of their parameters and processes, which can shed light on aspects of human cognition. As such, computational modeling has seen extensive use in the field of linguistics, notable examples including the use of iterated learning to demonstrate the spontaneous emergence of syntax \citep{kirby2002}, the use of incremental probabilistic parsing to model garden-path sentence comprehension \citep{hale2001}, and the use of Bayesian statistics to model referential inference \citep{frank2012}.

When selecting a modeling approach for \cite{rohde2012}, three crucial considerations must be taken into account: first, the chosen approach needs to represent the internal state of a participant with respect to the game, and to allow the participant's actions to be derived from this state, second, changes in a participant's internal state within the model need to be reflective of the participant's communicative success with their partner, even as their partner's internal state itself changes, and third, the modeling approach should be easily extensible to many variants of the \citeauthor{rohde2012} language games; particle swarm optimization is suitable in all three regards. As originally introduced by \citet*{kennedy1995}, particle swarm optimization (PSO) can serve not only as a general optimization method, but also as a means of modeling human social behaviour, especially in the context of collaborative problem solving \citep{kennedy1997}. These factors make the technique an ideal candidate for modeling the \citeauthor{rohde2012} studies. 

If possible, a particle-swarm-based model would allow a more exhaustive exploration of the effects of various form costs on referential coordination, offering a comprehensive picture of the circumstances under which ambiguous form entrainment is possible and likely. Further to this, an accurate particle-swarm-based model of human coordination in a discourse setting might shed light on more fundamental aspects of human cognition and social interaction as represented via the model's parameters. A successful model could also suggest PSO's suitability for the modeling of other linguistic phenomena. 

Conversely, if PSO is not a viable means of modeling the results observed in \citeauthor{rohde2012}, this could suggest a fundamental difference between human linguistic behaviours and other social behaviours as successfully modeled via PSO. A negative finding might also suggest that specialized methods are required to model more complex human social interactions.

To address these possibilities, this paper models \citeauthor{rohde2012}'s experiments as a PSO task, utilizing a mixed strategy search space to represent form production and comprehension. Two model variants as optimized to the \citeauthor{rohde2012} language games are presented, which differ in their treatment of the search space; one of these models is shown to compare favorably to a baseline PSO model. Both models respond to changes in form costs in a promisingly similar fashion to the observed experimental data, although neither perfectly replicates human trials.


\section{Background}
\subsection{Referential coordination}
\subsubsection{Overview}
Language is an inherently cooperative endeavour. To successfully understand and be understood by their interlocutors, speakers must actively coordinate their use of referring expressions, and rely on their communicative partners to do the same. The mechanisms by which this coordination can occur with relative facility are an active topic of research, and of special interest is to what extent speakers maintain internal models of their interlocutors in order to inform their communicative strategies. Research has also been devoted to the processes by which speakers balance the costs they incur when communicating against those incurred by their interlocutors, and how the interplay of these combined factors directs the evolution of referential mappings during discourse. While \citeauthor{rohde2012} is emblematic of a game-theoretic approach to these issues, the psycholinguistics literature has also covered them in detail; this section therefore provides an overview of previous work done in both communities.

\subsubsection{Game theoretic approaches}
Game theory provides a methodology for understanding agents' actions by modeling them as strategies within games. When deciding on which actions to choose, agents are said to attempt to maximize their expected utility by leveraging their knowledge of the game's state \citep{benz2005}. As applied to linguistics, game theoretic concepts can be used to describe a number of phenomena; for instance, \cite{jaeger2008} demonstrates how an evolutionary game-theoretic framework (in which systematic stability is maximized) can be successfully applied to the division of the vowel space in order to predict the vowel systems of modern-day languages.

\cite{lewis1969} established much of the foundation necessary to frame language in game-theoretic terms, including providing an account of the establishment of conventions as a coordinative (this is to say, positive-sum) game in which agents' interests are aligned.
His work has been built upon in order to apply game theory to the more specific problem of referential coordination. For example, by convention, the use of more general but costly referring expressions implicitly excludes the referents of easily accessed and more specific forms (e.g. ``cutter" versus ``knife", or ``some" versus ``all"). The establishment of this convention has been explained using an evolutionary (but ontogenetic) game-theoretic approach: both speaker and hearer benefit from an interpretation of the former which carries a greater degree of information (e.g. ``cutters which are not knives", ``some but not all") \citep{benz2005}. More recent work by \cite{degen2012} has used game theoretic models to predict participant behaviour in referential inference tasks with some success, although the researchers expressed the need for more nuanced, comprehensive models (an example of which this paper attempts to provide). 

\subsubsection{Psycholinguistic approaches}
The problem of referential coordination within the psycholinguistics literature has primarily been framed in terms of audience design. According to one school of thought, as presented in \cite{clark1982}, speakers carefully tailor utterances to best target their specific interlocutor or interlocutors; likewise, listeners interpret the meaning of utterances with respect not only to the speaker but, it is claimed, with respect to the speaker's presumed beliefs about the listener as well. Under this model, audience design on the speaker's part enables the listener to disambiguate the referent of an otherwise ambiguous referring expression, provided the listener's internal model of the speaker suffices to allow the listener to understand why the speaker has chosen that particular referring expression. 

As an example (adapted from \citeauthor{clark1982}), suppose Alice and Bob are conversing; Alice mentions to Bob something about ``your friend". Given the reasonable assumption that Bob has more than one friend, the referent of this expression is ambiguous. However, if Alice has met only one of Bob's friends, she may rely on him to recognize this fact and interpret the expression accordingly. From Bob's perspective, to disambiguate Alice's referring expression, he must both recall that Alice has met only one of his friends and  correctly reason that she will expect him to recall this (and to leverage this information to infer a referent). As interlocutors, over the course of a discourse or number of discourses, update and maintain their models of each other and the common information shared between them, they become increasingly entrained on specific lexical forms which are reflective of this shared knowledge and experience.

This understanding of referential coordination is borne out in \cite{golland2010}. \citeauthor{golland2010} utilize a game-theoretic approach to realize a language game in which an artificial speaker agent must successfully communicate a specified referent to their human listener partner. The researchers found that when this artificial speaker is endowed with an internally embedded model of the listener, it is able to substantially outperform simpler models which do not take the listener into account.

While this research makes the implicit assumption that the common ground between speaker and hearer informs production immediately when an utterance is initially being planned, \cite{horton1996} offers a competing view. In a human behavioural study in which participants were required to quickly produce referring expressions for their communicative partners, it was found that this time-sensitive pressure caused the participants to disrespect the common ground more frequently than when speed of production was not encouraged. This was taken to support the conclusion that the common ground does not inform initial utterance planning, but instead is taken into consideration as a filtering mechanism during later-stage utterance production. Furthermore, \citeauthor{horton1996} posited that the common ground may play no role whatsoever in the production of the majority of utterances, citing the potential costliness of routinely taking this information into consideration.

\subsubsection{Rohde et al. 2012}
In ``Communicating with Cost-based Implicature: a Game-Theoretic Approach to Ambiguity" \citeyearpar{rohde2012}, \citeauthor{rohde2012} present an iterated language game in which participants aim to indicate an object to their partner via use of one of several possible referring terms. Participants gain points upon successful communication, but must spend points in order to communicate. Each referent has a corresponding unambiguous form that players may choose to send to their partners; alternatively, players may send an ambiguous form with a different cost that could potentially indicate a number of referents. Players which attain a certain score are allowed to exit the experiment upon doing so, and are in this way incentivized to use the least costly possible expressions to achieve the highest rate of communicative success. Two studies were run; in both, two groups of three unambiguous referring expressions were paired with a single ambiguous referring expression which could plausibly be used for any item within the group (see Table \ref{table:rohde}). 

The studies run by \citeauthor{rohde2012} demonstrated the likelihood of a pair of participants to successfully coordinate their use of an ambiguous reference to be partially contingent on the relative costs of the unambiguous and ambiguous referring expressions. Specifically, pairs of participants were more likely to coordinate on using the ambiguous form in the second study, in which unambiguous form costs were both lower and more similar. This was notably not in keeping with game-theoretic predictions; \citeauthor{rohde2012} suggested that the lower stakes (i.e. more moderate penalties) in the second study resulted in a greater willingness on the part of the participants to explore a wider range of referential strategies.

\begin{table}
\begin{center}
    \begin{tabular}{ c r r }
    & \multicolumn{2}{ c }{Cost} \\ 
    Name & Study 1 & Study 2 \\ \hline
    ``Rose"   & $60$  & $80$ \\ \hline
    ``Daisy"  & $120$ & $140$ \\ \hline
    ``Tulip"  & $280$ & $165$ \\ \hline
    ``Flower" & $80$  & $80$ \\ \hline
    ``Apple Tree" & $60$  & $80$ \\ \hline
    ``Pine Tree"  & $120$ & $135$ \\ \hline
    ``Palm Tree"  & $250$ & $170$ \\ \hline
    ``Tree"       & $80$  & $80$ \\ 
    \end{tabular}
    \caption{Referring expression costs used in the \citeauthor{rohde2012} studies.}
    \label{table:rohde}
\end{center}
\end{table}


\subsection{Particle swarm optimization}
\subsubsection{Overview}
Particle swarm optimization was first formulated by \cite{kennedy1995} in an attempt to model human social behaviour. The initial model was based off of \cite{heppner1990}'s work in modeling bird flocking and roosting behaviour in two-dimensional space, refined to allow for an arbitrary number of dimensions and for particles to share the same or arbitrarily close positions within said multidimensional space. \citeauthor{kennedy1995} demonstrated that their new optimization method was suitable for use not only in modeling human social behaviour, but also for the general-purpose optimization of non-linear continuous problems. Specifically, PSO was found to be successful both in optimizing the weights of an artificial neural network and in the Schaffer $f6$ problem, a standard benchmark for general-purpose optimization methods \citep{davis1991}.

The concept behind the PSO algorithm is relatively simple. Potential solutions to some problem with $n$ dimensions are represented as particles existing within an $n$-dimensional search space. Each particle has both a position within this space and some velocity vector. Each particle also keeps track of the best position it has been in as evaluated by the given objective function, which is known as its ``personal" best position; a ``global" best position representing the best position found by all particles across a swarm or group is also maintained \citep{chong2013}. A PSO task is run iteratively, until some stopping criterion is reached \citep[p.~80]{solnon2010}. Every iteration begins by updating the velocities of all particles. In doing so, a particle is acted upon by two forces: the attraction of the particle to its personal previous best known position, as governed by a ``cognitive" parameter, and its attraction to the best known position within its group, as governed by a ``social" parameter \citep{chong2013}. The particle also maintains some momentum from its previous velocity. Following this, particle positions are updated in accordance with their velocities, with new positions being evaluated via the given objective function and best-known personal and global positions updated where appropriate. Initial particle velocities are assigned randomly; in doing so, exploration of the search space is encouraged, reducing the likelihood of the swarm as a whole becoming caught in a local extremum or local extrema of the objective function \citetwo{yang2014}{32}{solnon2010}{78, 81}. 

As noted by \citet*[p.~99]{yang2014}, PSO is applicable to a large domain of problems, has straightforward conceptual groundings, and is simple to implement; these factors have spurred on its widespread use in a number of fields, and resulted in the development of numerous refinements and derivatives of the original algorithm. This paper uses the well-known inertial variant of PSO, which offers a ``noticeable improvement" in speedy convergence on good solutions as compared to standard PSO \citep[p.~101]{yang2014}. Further to this variant, for the purposes of this paper each particle's position is updated with respect to the best-found solution within a predefined neighborhood or group of particles, as opposed to the global best-found solution, as presented in \citet*[p.~79]{solnon2010}. When these particle groups do not intersect, this is simply equivalent to running a number of independent PSO tasks equal to the number of groups.

% mention velocity clamping...? Engelbrecht 109 and in others


\subsubsection{Previous work}
\label{sec:pso_prev_work}

While PSO has been applied to a number of problems within the fields of linguistics and psychology, its primary use has been as a means of optimizing parameters for other models, as opposed to direct application as a model in and of itself (e.g. \citeauthor{chatterjee2005} \citeyear{chatterjee2005}; \citeauthor{mehdad2009} \citeyear{mehdad2009}). Notable exceptions to this trend include the use of PSO to perform unsupervised phoneme clustering \citep{ahmadi2007} and the modeling of human emergency evacuation behaviours via PSO \citep{cheng2008}.

PSO has likewise been applied to game learning, often using a coevolutionary paradigm in which agents play against one another in order to evaluate their fitness. However, traditionally this method has involved PSO over a search space of neural network weights, where the neural networks are used to choose actions given a game state, or in cases where the ``game" is a classical constraint optimization problem, such as the $n$-queens problem \citep[p.~349-351]{engelbrecht2005}. By contrast, in the new approach presented in this paper, the positions of particles themselves comprise agents' internal states, which directly define a mixed strategy (see \autoref{sec:search_space}).  

\subsubsection{Formulation and parameters}
\label{sec:2.2.3}
In the formulation of PSO employed in this paper, a particle $i$ with position $x_i$ has a velocity $v_i$ at time $t$ such that
\begin{equation}
v_i^t = \theta(t) \cdot v_i^{t-1} + \alpha \cdot \epsilon_1 \cdot (x_{N(i)}^* - x_i^{t-1}) + \beta \cdot \epsilon_2 \cdot (x_i^* - x_i^{t-1})
\end{equation},
where $\theta$ is the inertial scheduling function, $\alpha$ is the cognitive component, $\beta$ is the social component, $x_{N(i)}^*$ is the global best position known for $i$'s neighborhood or group $N(i)$, $x_i^*$ is $i$'s personal best known position, and $\epsilon_1$ and $\epsilon_2$ are randomly chosen values within $\left(0.0, 1.0\right]$. Although $\theta$ can take many forms including, most commonly, a constant function \citep{yang2014}, for the purposes of this paper $\theta$ is defined with respect to a base inertia $\tau$ and inertial dampening factor $\sigma$ such that
\begin{equation}
\theta(t) = \frac{\tau}{\sigma^t} 
\end{equation}
Finally, the position $x$ of $i$ at time $t$ is defined as
\begin{equation}
x_i^t = x_i^{t-1} + v_i^t 
\end{equation}

\section{Methods}

\subsection{Overview}

To model referential coordination within the \citeauthor{rohde2012} language game as a PSO task, individual participants were modeled as particles in groups of size $2$. In exploring the search space of possible game strategies, each particle sought to maximize its score within the language game in relation to the strategy of its partner. The scoring function of the language game itself was parameterized on the relative costs of unambiguous forms, as in \citeauthor{rohde2012}. Further to this, the parameters of the PSO algorithm (cognitive component, social component, etc.) were optimized to best replicate \citeauthor{rohde2012}'s experimental findings. Two models were ultimately produced\footnote{The full source code for this project is available online at \url{http://git.io/pb5S}.}, which differed in their handling of the search space; both were evaluated against the experimental data.

\subsection{Models}
\subsubsection{Search space}
\label{sec:search_space}

In modeling the \citeauthor{rohde2012} language game as a PSO task, the form a solution to the game takes must be considered in order to establish a search space.  To do so, the game-theoretic notion of a mixed strategy was adopted, in which each possible action $a$ within a game is performed by a participant $i$ with some probability $P_i(a)$ \citep{benz2005}. For the given language game, for each referent $r$ the participant can be said to maintain a probability of using the associated ambiguous form $A$, $P_i(A|r)$. Conversely, the probability of a participant using the available unambiguous form for $r$ can be given as $1 - P_i(A|r)$. Therefore, in an instance of the \citeauthor{rohde2012} language game with $n$ possible referents, a participant's strategy was represented with $n$ independent probabilities, yielding an $n$-dimensional search space. 

It is important to note that this does not constitute a traditional mixed strategy, in that a participant's strategy is not a probability distribution. This is to say, the sum of a participant's probability of using the ambiguous referring expression over all referents may not equal $1$. As an example, given two referents $r_1$ and $r_2$, a participant is capable of opting to use the ambiguous form for neither. In this sense, it may be more accurate to state that a participant $i$ maintains a separate mixed strategy for each referent $r$, where, for the ambiguous form $A$ and unambiguous form $U$, $P_i(A|r) + P_i(U|r) = 1$.

It is also important to note that for the purposes of this paper, participants were assumed to seek to optimize their strategies for groups of referents sharing the same ambiguous form independently of other groups\footnote{In \citeauthor{rohde2012} specifically, the flower category and tree category (see Table \ref{table:rohde}).}. As such, each of the studies presented in \citeauthor{rohde2012} were considered as two independent language games being run concurrently, and the PSO approach presented used 3-dimensional search spaces as opposed to 6-dimensional search spaces. This assumption was justified by the observation that participant pairs in \citeauthor{rohde2012}'s second study were able to coordinate their use of the ambiguous form for one group, but not the other. 

Finally, because each dimension in the search space defined above reflects a probability, values outside the interval $[0, 1]$ are invalid. A number of approaches for adapting PSO to constrained optimization problems have been suggested in the literature\footnote{See \cite{helwig2010} for a recent overview.}; two plausible alternatives as presented in \cite{engelbrecht2005} were considered, resulting in two competing models. 
In the first model, particles which moved outside the desired search space immediately had a repair method applied to them, whereby they were relocated to the nearest point which did not violate the given constraints. This model will be referred to as the ``repair" model. In the second model, particles were allowed to move freely within the search space, including to regions that violated constraints. However, particles not meeting the given constraints were allowed to update neither their personal best known position nor the global best position. Because all personal best positions and the global best position therefore remained in feasible space, particles were naturally attracted back to the region of the search space which respected the constraints. The model utilizing this technique will be referred to as the ``rejection" model. In both models, initial particle positions were assigned randomly within the valid search space.


 
\subsubsection{Objective function}
\label{sec:objective_func}
In applying PSO to the \citeauthor{rohde2012} language game, an appropriate representation of the game's goals must be formulated as an objective function. In the game as presented, the expected number of points awarded to participant $i$ given their partner $j$ when asked to communicate referent $r$ can be calculated as follows\footnote{N.B. that while the notation $P(x|y)$ is normally used solely to indicate the conditional probability of $x$ given $y$, this notation is here additionally used to indicate that $EP_i$ must be evaluated with regards to $i$'s partner $j$.}:
\begin{equation}
EP_{i}(r|j) = P_i(A|r)(S \cdot P_j(r|A) - cost_A) \,+\, (1 - P_i(A|r))(S - cost_r) 
\end{equation},
where $cost_A$ is the cost of production of the ambiguous form, $S$ is the number of points awarded on successful communication (set at 80 and 85 in \citeauthor{rohde2012}, respectively), and $cost_r$ is the cost of production of the unambiguous form for $r$.

Each round, the actual number of points awarded to participants is dependent on samples from $P_i$ and $P_j$, as well as the randomly-chosen $r$. As such, without the strategies of $i$ or $j$ changing, there are for any given round a number of possible scores $i$ might attain. Relying on the game unmodified as the objective function for a PSO task would therefore be imprudent, as an inconsistent objective function would be much harder to optimize. Instead, the objective function $f$ used for both models was chosen as 
\begin{equation}
f(i) = \sum_{r \in R} EP_{i}(r|j) + EP_{j}(r|i)
\end{equation}

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{objective_function_cropped.png}
\scalebox{.725}{\input{objective_function.pgf}}
\caption{$f(i)$ with respect to partner $j$ (marked as ``X") in a two-referent language game, with $cost_A=80$, $cost_{r_1}=60$, $cost_{r_2}=120$, and $S=85$. Note that in the scenario presented on the left, with $x_j = (0.1, 0.9)$, $f$'s global optimum is located in the bottom-left region of the search space, whereas in the scenario presented on the right, where $x_j = (0.9, 0.1)$, the global optimum is located at the bottom-right.}
\label{fig:1}
\end{figure}

There are a few issues to note with this formulation of $f$. Because the value of $f$ is dependent not only on the speaker's strategy, but also on the strategy their partner uses, because these strategies are a direct result of the positions of particles within the particle swarm, and because the positions of particles may change on every iteration of the PSO task, $f$ is \textit{extremely} dynamic. This dynamism is illustrated in \autoref{fig:1}. PSO is well-known for its resilience to dynamic functions, when accommodations are made by changing the methods by which particle velocities and best positions are updated \citep{engelbrecht2005}. However, the established accommodation techniques as presented in \cite{engelbrecht2005} are unsuitable for use here because they universally assume an objective function which updates periodically, not constantly\footnote{It should be noted here that while \citeauthor{engelbrecht2005}'s excellent treatment of these methods is extensive, it is not (and does not seek to be) exhaustive; see \cite{blackwell2007} for a more recent and in-depth discussion of this topic.}. Further, many of the techniques proposed make assumptions that would be implausible within the context of the \citeauthor{rohde2012} language game. For example, one technique is to reinitialize all or part of the particle swarm when the objective function changes, however, this would not only result in participants randomly changing strategies every iteration, but would be difficult to justify from a real-world perspective. In another technique, the associated scores for personal best and global best positions are recalculated when the objective function changes. Alternatively, in a variation of this method, personal best positions are entirely reinitialized and only the fitness of the global best position is recalculated. However, in the context of the language game, these would be equivalent to allowing participants to continuously re-evaluate previously held strategies against their partner's current strategy. Because no appropriate adaptations for dynamic fitness functions were found, the implementation of PSO used was not altered to accommodate $f$.

\subsection{Model parameter optimization}
\label{sec:param_opt}
To complete the models described above, the model parameters were optimized to best fit the experimental data. These parameters included the standard PSO parameters, namely, the cognitive and social components, which were restricted to the interval $[0,4]$, an inertial dampening factor, which was restricted to the interval $[1,1.1]$, and an initial inertia, which was restricted to $[0,4]$. Additionally, a velocity dampening constant, which was used in the calculation of particle positions and was restricted to $[0,2]$, and the number of iterations over which the model was to be run, as restricted to $[100,1000]$, were also optimized.

Optimization of these parameters was itself performed via PSO over a $6$-dimensional search space. The parameter values used for this meta-optimization task were those recommended in \cite{shi1998} and \cite{solnon2010}. Parameters were optimized over $1255$ iterations of the particle swarm algorithm for the ``repair" model; these parameters were then also applied to the ``rejection" model. The optimization task itself utilized the unbounded ``rejection" technique as recommended in \cite{engelbrecht2005}. Initial particle positions were assigned using the randomized nonuniform method presented in \cite{mitchell1991}.

The parameter optimization task sought to minimize the discrepancy in rates of ambiguous form coordination, unambiguous form coordination, and failure to coordinate between the model and the experimental data, across all language game variants. In order to evaluate this and compare model behaviour with the behaviour of human participants in the task, pairs were considered to have coordinated if, when the PSO task had completed, referents could be successfully communicated between the pair $\geq 95\%$ of the time.
\clearpage


\section{Results}
\subsection{Meta-optimization task (PSO parameters)}
\label{sec:parameter_optimization}
\begin{center}
    \begin{tabular}{ l l l r }
    Parameter & Optimized & Baseline & $\% \Delta$ \\ \hline
    Cognitive component       & $0.689$ & $2.0$   & $-65.55\%$ \\ \hline
    Social component          & $2.897$ & $2.0$   & $+44.86\%$ \\ \hline
    Inertial dampening factor & $1.027$ & $1.001$ & $+2.58\%$\\ \hline
    Initial inertia           & $0.658$ & $1.2$   & $-45.17\%$ \\ \hline
    Velocity dampening factor & $1.202$ & $1.0$     & $+20.20\%$\\ \hline
    Iterations                & $305$   & N/A     & N/A\\ 
    \end{tabular}
   	\captionof{table}{Comparison of optimized PSO parameters against those recommended in \cite{shi1998} and \cite{solnon2010}.}
	\label{table:1}
\end{center}

\subsection{Comparison of models to experimental data}
\label{sec:model_comparison}
Results for both the rejection and repair models are compared against a baseline model, which makes use of the standard parameters used in the meta-optimization task. For each model, 250 simulations of 10 pairs were performed for each of the sets of costs used in \citeauthor{rohde2012} (see Table \ref{table:2}).
\begin{table}
\begin{center}
    \begin{tabular}{ l r r r r }
    Experiment & $cost_{r_1}$ & $cost_{r_2}$ & $cost_{r_3}$ & $cost_A$\\ \hline
    Experiment 1 & $60$ & $120$ & $280$ & $80$ \\ \hline
    Experiment 2 & $60$ & $120$ & $250$ & $80$ \\ \hline
    Experiment 3 & $80$ & $140$ & $165$ & $80$ \\ \hline
    Experiment 4 & $80$ & $135$ & $170$ & $80$ \\ 
    \end{tabular}
    \caption{Referring expression costs used in the \citeauthor{rohde2012} studies.}
    \label{table:2}
\end{center}
\end{table}

To assess how similarly each model responded to changing costs as compared to human participants, scaling factors for each model were derived by minimizing the squared error in ambiguous form coordination rates. The scaling factors are presented in Table \ref{table:3}. A comparison of the scaled results from each model to the experimental data is given in Figure \ref{fig:model_comp}. To then compare the error rates for scaled ambiguous form coordination across the three models (see Figure \ref{fig:2}), an ANOVA was conducted predicting error rate given model type, with no random effects (i.e., error for each simulation treated as an independent observation).  The repair model was shown to have a significantly lower error than the baseline ($F(1, 1998) = 921.3$, $p<0.001$) and than the rejection model ($F(1, 1998) = 924.3$, $p<0.001$).

\begin{table}
\begin{center}
    \begin{tabular}{ l r }
    Model & Scaling factor \\ \hline
    Rejection & $21.16$ \\ \hline
    Repair & $2.19$ \\ \hline
    Baseline & $11.33$ \\ \hline
    \end{tabular}
    \caption{Scaling factors used for each model.}
    \label{table:3}
\end{center}
\end{table}

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{objective_function_cropped.png}
\scalebox{.7}{\input{model_comparison.pgf}}
\caption{Comparison of ambiguous form coordination rates for all models against the experimental data. Rates scaled as per Table \ref{table:3}; experimental conditions described in Table \ref{table:2}.}
\label{fig:model_comp}
\end{figure}

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{objective_function_cropped.png}
\scalebox{.725}{\input{model_errors.pgf}}
\caption{Comparison of error in scaled coordination rate across the repair, rejection and baseline models (outliers left unplotted).}
\label{fig:2}
\end{figure}

%\begin{center}
%\includegraphics[width=\textwidth]{ambi_coord_exp1.png}
%\textit{Is there a more cohesive way of presenting these? Should these box/whisker plots in particular perhaps be moved to an appendix?}
%\includegraphics[width=\textwidth]{ambi_coord_exp2.png}
%\includegraphics[width=\textwidth]{ambi_coord_exp3.png}
%\includegraphics[width=\textwidth]{ambi_coord_exp4.png}
%\end{center}
%
%\begin{center}
%\includegraphics[width=\textwidth]{ambiguous_coordination_rejection.png}
%\textit{Given that these are all at different scales, is there a way to present them together for comparison? How to choose/justify the scaling?}
%\includegraphics[width=\textwidth]{ambiguous_coordination_repair.png}
%\includegraphics[width=\textwidth]{ambiguous_coordination_baseline.png}
%\includegraphics[width=\textwidth]{ambiguous_vs_unambiguous_smaller.png}
%\textit{What is the most appropriate way to measure whether either of the two optimized models tracks the experimental data more effectively than the baseline model?}
%\end{center}

\subsection{Predictions from repair model}
\subsubsection{Cost and reward variation}
As the repair model was shown to outperform both the rejection and baseline models in mimicking experimental data when scaled ($p<0.001$, see \ref{sec:model_comparison}), it was chosen to predict referential coordination behaviours outside those conditions studied in \citeauthor{rohde2012}. The results of varying ambiguous form cost on ambiguous and unambiguous form coordination \textit{ceteris paribus} are presented in Figure \ref{fig:3}
\footnote{It should be noted that because coordination rates have been scaled here as per Table \ref{table:3}, the combined rates in some instances exceed $100\%$. The rates could be normalized or the scaling factor adjusted to avoid this; alternatively, an alternative choice of parameters for the model might obviate the need for a scaling factor and, in doing so, eliminate the issue.}
, while Figure \ref{fig:4} demonstrates the effects of adjusting the number of points awarded for successful communication.

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{objective_function_cropped.png}
\scalebox{.725}{\input{vary_cost_a.pgf}}
\caption{Average entrainment rates in Experiment 1 with ambiguous form cost varied, as predicted by the repair model.}
\label{fig:3}
\end{figure}

\begin{figure}
\centering
%\includegraphics[width=\textwidth]{objective_function_cropped.png}
\scalebox{.725}{\input{vary_s.pgf}}
\caption{Average entrainment rates in Experiment 1 with successful communication reward varied, as predicted by the repair model.}
\label{fig:4}
\end{figure}

\subsubsection{Variation of discourse context after entrainment}
It is a well established phenomenon that interlocutors who entrain on the use of a high-cost but unambiguous referring expression in a discourse environment containing similar referents will only infrequently switch to using a less costly but more general referring expression when a new discourse \mbox{context} would allow them to do so unambiguously \citep{brennan1996}: an apparent violation of the Gricean maxim of quantity \citep{grice1975}. To investigate whether this property holds for artificial agents within the repair model, two experiments were conducted which varied in their dimensionality and form costs (see Table \ref{table:4}). For both experiments, to simulate previous entrainment on the unambiguous form, a swarm of particles $I$ was initialized such that $\forall i \in I, \forall r \in R, P_i(A|r) = 0$; further, the initial inertia parameter was modified from the optimized value presented in Table \ref{table:1} so as to reflect 305 iterations of the PSO algorithm having already been run\footnote{As calculated using equation 2 (presented in \ref{sec:2.2.3}), with optimized inertial dampening factor having been left unchanged from Table \ref{table:1}.}. With these initial conditions set, the PSO algorithm was then run on the swarm for an ``additional" 305 iterations.

For both experiment A and B, 250 simulations were run. In no simulation under either condition did the number of agent pairs entrained on unambiguous forms initially differ from the final number after the simulation had concluded; this is to say, all agents continued using the more costly unambiguous forms.

\begin{table}
\begin{center}
    \begin{tabular}{ l r r r r }
    Experiment & $cost_{r_1}$ & $cost_{r_2}$ & $cost_{r_3}$ & $cost_A$\\ \hline
    Experiment A & $80$  & $140$ & $165$ & $80$ \\ \hline
    Experiment B & $280$ &       &       & $80$ \\ \hline
    \end{tabular}
    \caption{Form costs for experiments A and B, which differ in their dimensionality. Note that experiment A's costs are identical to those of Table \ref{table:2}, experiment 3, for which \citeauthor{rohde2012} recorded the highest rate of ambiguous form coordination.}
    \label{table:4}
\end{center}
\end{table}



\section{Discussion and further work}
\subsection{Meta-optimization task}
The optimization of PSO parameters to the target language game (\ref{sec:parameter_optimization}) resulted in a set of parameters which differed quite noticeably from those known to provide good solutions for general problems (e.g. the \textit{f6} function). The most salient changes were to the cognitive and social components. Whereas best practice normally dictates that these parameters be set roughly equal to each other, in the optimized parameters, cognitive component was reduced by roughly $66\%$, and social component was increased by roughly $45\%$. 

There are a number of possible explanations for these discrepancies. Recall from   
equation 1 (\ref{sec:2.2.3}) that the cognitive component determines how attracted a particle is to its own previously best-found position, and that the social component determines how attracted a particle is to the best-found solution within its group (in this instance, within its dyad). Recall also from \ref{sec:objective_func} that one possible technique for handling dynamic objective functions is, on objective function change, to reinitialize or discard personal best positions and to recalculate the fitness of the global best-found position. While the latter is only achievable through a modification of the core PSO algorithm, in a scenario wherein the objective function changes every iteration, the former is tantamount to lowering the cognitive component to zero. As the language game modeled here is evaluated for each particle against its partner's position, which is updated on every iteration, the game's objective function matches this description; the significant lowering of the cognitive component in optimized parameters for the game can therefore be interpreted as an implementation of the previously described dynamic function adaptation technique.

Another possible explanation of the divergence of these parameters from their standard values is that this is reflective of the nature of the chosen objective function. Language is an inherently cooperative endeavour; it would therefore come as no great surprise if referential coordination games encouraged favouring the best strategies across all communicative partners over those that maximize individual fitness. Indeed, the parameter optimization results may be reflective of general human eusociality. It is important, however, to note that any conclusions of this nature drawn from the parameter optimization task must be taken with a pinch of salt; the underabundance of data from \citeauthor{rohde2012} and resultant infeasibility of dividing the data into test and training sets almost certainly assures that the models have been grossly overfit. Confirmation of these results would require not only more extensive human trials under a number of conditions, but also a thorough examination of how adjusting each of the PSO parameters in isolation impacts the model's results.

\subsection{Comparison of models}
Despite the optimization of PSO parameters, none of the evaluated models were able to closely replicate the raw ambiguous and unambiguous form coordination rates observed in \citeauthor{rohde2012}. However, all three models tested exhibited proportional changes in response to varied form costs similarity to those exhibited in the human studies. Of the three models, the repair model was shown to clearly outperform the rejection and baseline models both in terms of magnitude of adjustment needed to minimize error (Table \ref{table:3}) and goodness of fit to the experimental data when scaled (Figure \ref{fig:2}). This cannot be said to be a particularly surprising result, given that the PSO parameter optimization was performed on swarms using the repair technique, as opposed to the rejection technique (see \ref{sec:param_opt}). It remains to be seen whether the relatively poor results of the rejection model might match or exceed those of the repair model were parameters to be optimized for this model specifically. A further question is that of initial particle positions: while in this paper an initial position for each particle was assigned randomly, it seems likely that humans will have prior biases that inform their initial strategies; this may account for the increased rates of coordination on the ambiguous form observed in the \citeauthor{rohde2012} human studies.

An important feature to note of the PSO models is the simplicity with which agents are represented. Particles within the swarm consist solely of their current position within the search space, their velocity, and a record of the globally and personally best-found positions. Apart from these, agents have no form of memory whatsoever. Despite this, referential coordination and entrainment behaviours which mirror those of human participants are possible. This presents an account of referential coordination much more in keeping with the work of \citeauthor{horton1996} than the \citeauthor{clark1982} view, especially given that agents maintain no explicit model of their communicative partners. Instead, referential coordination occurs as a response to previous successes, failures, and incurred production costs, resulting in an implicit representation or reflection of the common ground via the agents' mixed strategies. 

\subsection{Repair model predictions}
In \citeauthor{rohde2012}, it was argued that the lower stakes in the researchers' second study\footnote{Experiments 3 and 4.} (by way of more similar and lower form costs) resulted in more frequent coordination on the ambiguous form by encouraging participants to explore a variety of referential strategies. This appears to be borne out in the predictions generated from the repair model for various successful communication rewards (see Figure \ref{fig:4}). As the reward for successful communication increases (and overall success becomes more guaranteed), simulated dyads become more likely to coordinate using either the ambiguous form or unambiguous forms, exceeding the rates of coordination observed in human trials. Likewise, when success provides less of an award or even a penalty, referential coordination rates drop sharply. 

However, seemingly paradoxically, increasing the cost of the ambiguous form was also predicted to increase ambiguous form coordination rates (see Figure \ref{fig:3}). A possible explanation for this observation is that increasing ambiguous form costs more readily indicate for which of the three referents it should be produced, rather than the corresponding unambiguous form. For example, in experiment 1 the cost of the ambiguous form (80) is less than the cost both of $r_2$ (120) and $r_3$ (280). Because of this, agents may differ in their choice of strategies, since using the ambiguous form for either referent increases score, or indeed may attempt to use the ambiguous form for both referents simultaneously, reducing overall communicative success. When the cost of the ambiguous form is lowered further, all three unambiguous forms become more costly, confusing the matter further. By contrast, when ambiguous form cost exceeds the cost of all but one unambiguous form, the referential strategy in which the use of this form is replaced with the use of the ambiguous form becomes highly preferred, as compared to all other strategies. As the ambiguous form cost approaches that of the most costly unambiguous form, this effect becomes more pronounced. This reasoning would not explain why the rate of coordination using the ambiguous form was predicted to remain high after its cost exceeded that of the costliest of the three unambiguous forms; the simplest answer may be that, without further training data, the model is invalid for such extrema. Regardless, additional human studies would be needed to either verify these results or provide measurements against which to correct the model.

While the repair model was able to replicate the overinformativity behaviour observed in \citeauthor{brennan1996} without having been trained to do so, in the human studies conducted by \citeauthor{brennan1996} this effect was not observed to be universal, unlike in the PSO predictions. This is not taken to be problematic, considering no effort was undertaken to establish how many iterations of the PSO model in the \citeauthor{rohde2012} language games might correspond to the duration of entrainment in the \citeauthor{brennan1996} studies.

The predictions presented here have covered only a small number of possible variations on the \citeauthor{rohde2012} language games. It remains to be seen how larger groups, alternate group topologies (e.g. intersecting groups), varied unambiguous form costs, varied number of referents, and a multitude of other experimental conditions might affect referential coordination. The further use of the PSO model to generate predictions for these conditions has the potential to highlight areas where further work, either experimental or theoretical, is needed.



\section{Conclusion}
This paper sought to model the findings of \citeauthor{rohde2012} computationally, and to extrapolate beyond the conditions tested in that work. The paper has demonstrated that PSO offers a framework for replicating the human responses observed in the \citeauthor{rohde2012} language game studies; in particular, this paper has identified a constraint handling technique and associated set of parameters for the PSO algorithm (the ``repair" model) which yields a statistically significant improvement in replicating the experimental data over an alternative technique (``rejection") and set of baseline PSO parameters. The resultant model has then been used to predict the effects of varying costs and rewards in one of the \citeauthor{rohde2012} language games on dyadic ambiguous form entrainment. Predictions were also made which appeared to be in keeping with effects noted in \citeauthor{brennan1996}. Overall, the findings appear to demonstrate that it is not unreasonable to explain referential coordination between interlocutors in terms of a generalized optimization process (in which communicative success is maximized and communicative costs minimized), without needing to take into account complex or specialized linguistic processes or reasoning methods.

\pagebreak
\bibliographystyle{apacite}
\bibliography{dissertation.bib}


\end{document}
